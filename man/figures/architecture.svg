<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 620" font-family="'Palatino Linotype','Georgia','Noto Serif KR',serif">
  <defs>
    <marker id="arrow" markerWidth="7" markerHeight="5" refX="7" refY="2.5" orient="auto">
      <polygon points="0 0, 7 2.5, 0 5" fill="#333"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="620" fill="#fffff8"/>

  <!-- Title -->
  <text x="450" y="36" text-anchor="middle" font-size="18" fill="#111" font-weight="600" letter-spacing="0.5">pandoc-hwpx</text>
  <text x="450" y="56" text-anchor="middle" font-size="11" fill="#888" font-style="italic">Quarto to HWPX Conversion Pipeline — Pure Lua, No Python</text>

  <!-- ═══════════ TOP: Quarto Pipeline ═══════════ -->

  <text x="24" y="96" font-size="9" fill="#999" letter-spacing="1.5" font-variant="small-caps">QUARTO PIPELINE</text>
  <line x1="24" y1="101" x2="200" y2="101" stroke="#ddd" stroke-width="0.5"/>

  <!-- .qmd -->
  <rect x="24" y="112" width="100" height="44" rx="2" fill="none" stroke="#333" stroke-width="1"/>
  <text x="74" y="131" text-anchor="middle" font-size="11" fill="#333">.qmd</text>
  <text x="74" y="147" text-anchor="middle" font-size="8" fill="#888">format: hwpx-docx</text>

  <line x1="124" y1="134" x2="162" y2="134" stroke="#333" stroke-width="1" marker-end="url(#arrow)"/>

  <!-- Quarto render -->
  <rect x="168" y="112" width="136" height="44" rx="2" fill="#f4f1eb" stroke="#333" stroke-width="1"/>
  <text x="236" y="131" text-anchor="middle" font-size="11" fill="#333" font-weight="600">Quarto</text>
  <text x="236" y="147" text-anchor="middle" font-size="9" fill="#666">knitr / jupyter</text>

  <line x1="304" y1="134" x2="338" y2="134" stroke="#333" stroke-width="1" marker-end="url(#arrow)"/>

  <!-- Pandoc -->
  <rect x="344" y="112" width="100" height="44" rx="2" fill="#f4f1eb" stroke="#333" stroke-width="1"/>
  <text x="394" y="131" text-anchor="middle" font-size="11" fill="#333" font-weight="600">Pandoc</text>
  <text x="394" y="147" text-anchor="middle" font-size="9" fill="#666">AST + citeproc</text>

  <line x1="444" y1="134" x2="474" y2="134" stroke="#333" stroke-width="1" marker-end="url(#arrow)"/>

  <!-- ═══════════ RIGHT: Lua Filter Engine ═══════════ -->

  <rect x="476" y="82" width="400" height="246" rx="3" fill="#eef0f6" stroke="#667" stroke-width="1.5"/>
  <text x="676" y="102" text-anchor="middle" font-size="12" fill="#111" font-weight="600">hwpx-filter.lua</text>
  <text x="676" y="115" text-anchor="middle" font-size="9" fill="#999" font-style="italic">pure Lua engine  ~1,950 lines</text>
  <line x1="491" y1="122" x2="861" y2="122" stroke="#ccd" stroke-width="0.5"/>

  <!-- Stage 1 -->
  <circle cx="502" cy="142" r="10" fill="#e8e5de" stroke="#999" stroke-width="0.5"/>
  <text x="502" y="145" text-anchor="middle" font-size="8" fill="#555" font-weight="600">1</text>
  <text x="520" y="145" font-size="10" fill="#333">Meta + source parsing</text>
  <text x="520" y="156" font-size="8" fill="#999">title, author, citeproc, callout types from .qmd</text>

  <!-- Stage 2 -->
  <circle cx="502" cy="176" r="10" fill="#e8e5de" stroke="#999" stroke-width="0.5"/>
  <text x="502" y="179" text-anchor="middle" font-size="8" fill="#555" font-weight="600">2</text>
  <text x="520" y="179" font-size="10" fill="#333">Template loading</text>
  <text x="520" y="190" font-size="8" fill="#999">unzip blank.hwpx + header.xml patching</text>

  <!-- Stage 3 -->
  <circle cx="502" cy="210" r="10" fill="#e8e5de" stroke="#999" stroke-width="0.5"/>
  <text x="502" y="213" text-anchor="middle" font-size="8" fill="#555" font-weight="600">3</text>
  <text x="520" y="213" font-size="10" fill="#333">Block processing</text>
  <text x="520" y="224" font-size="8" fill="#999">Header, Table, gt, Callout(5), Figure, List, Code</text>

  <!-- Stage 4 -->
  <circle cx="502" cy="244" r="10" fill="#e8e5de" stroke="#999" stroke-width="0.5"/>
  <text x="502" y="247" text-anchor="middle" font-size="8" fill="#555" font-weight="600">4</text>
  <text x="520" y="247" font-size="10" fill="#333">Inline formatting</text>
  <text x="520" y="258" font-size="8" fill="#999">Bold, Code, Link, Image, Math, Footnote</text>

  <!-- Stage 5 -->
  <circle cx="502" cy="278" r="10" fill="#e8e5de" stroke="#999" stroke-width="0.5"/>
  <text x="502" y="281" text-anchor="middle" font-size="8" fill="#555" font-weight="600">5</text>
  <text x="520" y="281" font-size="10" fill="#333">XML assembly + ZIP</text>
  <text x="520" y="292" font-size="8" fill="#999">section0 + header + content.hpf → .hwpx</text>

  <!-- Vertical connectors -->
  <line x1="502" y1="152" x2="502" y2="166" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
  <line x1="502" y1="186" x2="502" y2="200" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
  <line x1="502" y1="220" x2="502" y2="234" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>
  <line x1="502" y1="254" x2="502" y2="268" stroke="#ccc" stroke-width="0.5" stroke-dasharray="2,2"/>

  <!-- Built-in modules sidebar -->
  <line x1="690" y1="132" x2="690" y2="320" stroke="#ccd" stroke-width="0.5"/>
  <g transform="translate(0, -5)">
    <text x="700" y="145" font-size="9" fill="#555" font-weight="600">Built-in Modules</text>
    <text x="700" y="161" font-size="9" fill="#667">math_converter</text>
    <text x="704" y="172" font-size="8" fill="#999" font-style="italic">LaTeX → HWP equation script</text>
    <text x="700" y="187" font-size="9" fill="#667">lineseg_calculator</text>
    <text x="704" y="198" font-size="8" fill="#999" font-style="italic">line break positions for Mac</text>
    <text x="700" y="213" font-size="9" fill="#667">image_dimensions</text>
    <text x="704" y="224" font-size="8" fill="#999" font-style="italic">PNG/JPEG header parse</text>
    <text x="700" y="239" font-size="9" fill="#667">openxml_parser</text>
    <text x="704" y="250" font-size="8" fill="#999" font-style="italic">gt &lt;w:tbl&gt; → hp:tbl</text>
    <text x="700" y="265" font-size="9" fill="#667">callout_renderer</text>
    <text x="704" y="276" font-size="8" fill="#999" font-style="italic">5-type, source-based detection</text>
    <text x="700" y="291" font-size="9" fill="#667">caption_style</text>
    <text x="704" y="302" font-size="8" fill="#999" font-style="italic">9pt italic, centered paraPr</text>
    <text x="700" y="317" font-size="9" fill="#667">charPr_manager</text>
    <text x="704" y="325" font-size="8" fill="#999" font-style="italic">dynamic style ID cache</text>
  </g>


  <!-- Arrow from engine to HWPX -->
  <line x1="676" y1="328" x2="676" y2="372" stroke="#333" stroke-width="1" marker-end="url(#arrow)"/>
  <text x="686" y="356" font-size="8" fill="#999" font-style="italic">ZIP</text>

  <!-- ═══════════ LEFT MARGIN: System Dependencies ═══════════ -->

  <text x="24" y="196" font-size="9" fill="#999" letter-spacing="1.5" font-variant="small-caps">DEPENDENCIES</text>
  <line x1="24" y1="201" x2="160" y2="201" stroke="#ddd" stroke-width="0.5"/>
  <text x="24" y="218" font-size="9" fill="#555">zip / unzip</text>
  <text x="28" y="230" font-size="8" fill="#999" font-style="italic">system commands (macOS/Linux)</text>
  <text x="24" y="248" font-size="9" fill="#555">No Python</text>
  <text x="28" y="260" font-size="8" fill="#999" font-style="italic">pure Lua, zero pip install</text>

  <!-- ═══════════ LEFT MARGIN: Namespace Prefixes ═══════════ -->

  <text x="24" y="290" font-size="9" fill="#999" letter-spacing="1.5" font-variant="small-caps">XML NAMESPACES</text>
  <line x1="24" y1="295" x2="160" y2="295" stroke="#ddd" stroke-width="0.5"/>
  <text x="24" y="311" font-size="8" fill="#667" font-weight="600">hp:</text>
  <text x="46" y="311" font-size="8" fill="#999">paragraph, table, pic</text>
  <text x="24" y="323" font-size="8" fill="#667" font-weight="600">hh:</text>
  <text x="46" y="323" font-size="8" fill="#999">charPr, paraPr, borderFill</text>
  <text x="24" y="335" font-size="8" fill="#667" font-weight="600">hc:</text>
  <text x="46" y="335" font-size="8" fill="#999">fillBrush, margin values</text>
  <text x="24" y="347" font-size="8" fill="#667" font-weight="600">hs:</text>
  <text x="46" y="347" font-size="8" fill="#999">section, page layout</text>

  <!-- ═══════════ BOTTOM: HWPX Structure ═══════════ -->

  <rect x="190" y="380" width="680" height="222" rx="3" fill="#fafaf5" stroke="#333" stroke-width="1.5"/>
  <text x="530" y="402" text-anchor="middle" font-size="13" fill="#111" font-weight="600">output.hwpx</text>
  <text x="530" y="416" text-anchor="middle" font-size="9" fill="#999" font-style="italic">HWPX = ZIP archive containing OOXML-like XML structure (KS X 6101 / OWPML)</text>
  <line x1="205" y1="423" x2="855" y2="423" stroke="#ddd" stroke-width="0.5"/>

  <!-- Contents/ -->
  <text x="215" y="444" font-size="10" fill="#333" font-weight="600">Contents/</text>

  <!-- section0.xml -->
  <rect x="230" y="454" width="160" height="66" rx="2" fill="#eef4ee" stroke="#8a8" stroke-width="0.8"/>
  <text x="310" y="470" text-anchor="middle" font-size="10" fill="#333" font-weight="600">section0.xml</text>
  <text x="310" y="483" text-anchor="middle" font-size="8" fill="#666">hp:p  hp:tbl  hp:pic</text>
  <text x="310" y="494" text-anchor="middle" font-size="8" fill="#666">hp:equation  hp:footNote</text>
  <text x="310" y="505" text-anchor="middle" font-size="8" fill="#999" font-style="italic">document body + callout tables</text>

  <!-- header.xml -->
  <rect x="406" y="454" width="160" height="66" rx="2" fill="#eeeef4" stroke="#88a" stroke-width="0.8"/>
  <text x="486" y="470" text-anchor="middle" font-size="10" fill="#333" font-weight="600">header.xml</text>
  <text x="486" y="483" text-anchor="middle" font-size="8" fill="#666">fontfaces  charProperties</text>
  <text x="486" y="494" text-anchor="middle" font-size="8" fill="#666">paraProperties  borderFills</text>
  <text x="486" y="505" text-anchor="middle" font-size="8" fill="#999" font-style="italic">styles + dynamic callout fills</text>

  <!-- content.hpf -->
  <rect x="582" y="454" width="160" height="66" rx="2" fill="#f4eee8" stroke="#a86" stroke-width="0.8"/>
  <text x="662" y="470" text-anchor="middle" font-size="10" fill="#333" font-weight="600">content.hpf</text>
  <text x="662" y="483" text-anchor="middle" font-size="8" fill="#666">metadata  manifest</text>
  <text x="662" y="494" text-anchor="middle" font-size="8" fill="#666">image references</text>
  <text x="662" y="505" text-anchor="middle" font-size="8" fill="#999" font-style="italic">package manifest</text>

  <!-- BinData/ -->
  <text x="215" y="540" font-size="10" fill="#333" font-weight="600">BinData/</text>

  <!-- Images box -->
  <rect x="230" y="548" width="160" height="40" rx="2" fill="#f8f4f0" stroke="#baa" stroke-width="0.8"/>
  <text x="310" y="566" text-anchor="middle" font-size="10" fill="#333">images</text>
  <text x="310" y="578" text-anchor="middle" font-size="8" fill="#999" font-style="italic">.png  .jpg  embedded</text>

  <!-- Fonts box -->
  <rect x="406" y="548" width="160" height="40" rx="2" fill="#f8f4f0" stroke="#baa" stroke-width="0.8"/>
  <text x="486" y="566" text-anchor="middle" font-size="10" fill="#333">fonts</text>
  <text x="486" y="578" text-anchor="middle" font-size="8" fill="#999" font-style="italic">NanumSquare  D2Coding  ...</text>

  <!-- mimetype + META-INF -->
  <rect x="582" y="548" width="160" height="40" rx="2" fill="#f0f0f0" stroke="#aaa" stroke-width="0.8"/>
  <text x="662" y="566" text-anchor="middle" font-size="10" fill="#333">mimetype</text>
  <text x="662" y="578" text-anchor="middle" font-size="8" fill="#999" font-style="italic">META-INF/container.xml</text>

</svg>
